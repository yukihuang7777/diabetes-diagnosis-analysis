## EDA(Covarites)

```{r}
library(corrplot)
library(dplyr)
```

```{r}
# load the data and select variabls in research question
diabetes <- read.csv('diabetes_dataset.csv')

```

```{r}
# check if there are missing values and summarize dataset
colSums(is.na(diabetes))
str(diabetes)
summary(diabetes)
```

To explore how individual covariates may be associated with the probability of being diagnosed with diabetes, we conducted exploratory visualizations and statistical summaries. The covariates analyzed include **glucose level**, **HbA1c level**, **family history of diabetes**, and **medication use**.

```{r}
# boxplot between Glucose and Outcome
boxplot(Glucose ~ Outcome,
        data = diabetes,
        main = "Glucose Level by Diabetes Status",
        xlab = "Diabetes (0 = No, 1 = Yes)",
        ylab = "Glucose Level",
        col = c("lightblue", "salmon"))
```

This pattern aligns with clinical understanding, where elevated blood glucose is a primary indicator of diabetes. The visual evidence strongly supports the inclusion of glucose level as a key predictor in modeling diabetes diagnosis.

```{r}
# boxplot between HbA1c and Outcome
boxplot(HbA1c ~ Outcome,
        data = diabetes,
        main = "HbA1c Level by Diabetes Status",
        xlab = "Diabetes (0 = No, 1 = Yes)",
        ylab = "HbA1c Level",
        col = c("lightblue", "salmon"))

```

Individuals diagnosed with diabetes tend to have significantly higher **glucose** and **HbA1c** levels, are more likely to have a **family history of diabetes**, and report **greater medication use**, highlighting all four as strong indicators of disease presence.

```{r}
# barplot between FamilyHistory and Proportion of Outcome
barplot(prop.table(table(diabetes$FamilyHistory, diabetes$Outcome), 1),
        beside = TRUE,
        col = c("lightblue", "salmon"),
        legend = c("No Diabetes", "Diabetes"),
        names.arg = c("No Family History", "Family History"),
        main = "Proportion of Diabetes by Family History",
        ylab = "Proportion")

```

The barplot presents the proportion of diabetes by **medication use**, which also shows only moderate variation between groups. Moreover, **medication use** likely occurs after diagnosis, making it a consequence rather than a predictive factor.

```{r}
# barplot between MedicationUse and Proportion of Outcome
barplot(prop.table(table(diabetes$MedicationUse, diabetes$Outcome), 1),
        beside = TRUE,
        col = c("lightblue", "salmon"),
        legend = c("No Diabetes", "Diabetes"),
        names.arg = c("No Medication", "Using Medication"),
        main = "Proportion of Diabetes by Medication Use",
        ylab = "Proportion")

```

The barplot shows a boxplot of **BMI** by Diabetes Status, revealing only a marginal difference in median **BMI** between the two groups, with substantial overlap. This indicates limited discriminative power for predicting diabetes in this dataset.

```{r}
boxplot(diabetes$BMI ~ Outcome,
        data = diabetes,
        main = "BMI by Diabetes Status",
        xlab = "Diabetes (0 = No, 1 = Yes)",
        ylab = "BMI",
        col = c("lightblue", "salmon"))
```

```{r}
clean_data <- diabetes[!is.na(diabetes$Hypertension) & !is.na(diabetes$Outcome), ]

# 创建交叉表
htn_tab <- table(clean_data$Hypertension, clean_data$Outcome)

# 计算比例
htn_prop <- prop.table(htn_tab, 1)

# 绘图
barplot(htn_prop,
        beside = TRUE,
        col = c("skyblue", "tomato"),
        legend = c("No Diabetes", "Diabetes"),
        names.arg = c("No Hypertension", "Has Hypertension"),
        main = "Proportion of Diabetes by Hypertension Status",
        ylab = "Proportion")

```

## EDA(Heatmap)

```{r}
diabetes <- diabetes %>% 
  select(Outcome,Glucose,HbA1c,FamilyHistory,MedicationUse)
```

```{R}
# heatmap for selected data
corrplot(cor(diabetes), method = "color", addCoef.col = "black")
```

```{r}
plot(diabetes$Glucose, diabetes$HbA1c,
     main = "Relationship between Glucose and HbA1c",
     xlab = "Glucose",
     ylab = "HbA1c",
     pch = 19, col = "darkgray")
abline(lm(HbA1c ~ Glucose, data = diabetes), col = "blue", lwd = 2)

```

Although the individual correlations between **Glucose** and **Outcome** (0.17), and between **HbA1c** and **Outcome** (0.15), appear relatively weak, the correlation between **Glucose** and **HbA1c** themselves is substantially high (0.82).\
Therefore, this study seeks to investigate whether the strong **covariation** between Glucose and HbA1c may influence the model outcome when both variables are included, either individually or jointly.
